/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package et.bo.screen.action;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import net.sf.json.JSONArray;

import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

import et.bo.caseinfo.generalCaseinfo.service.GeneralCaseinfoService;
import et.bo.focusTracking.service.FocusTrackingService;
import et.bo.messages.service.MessagesService;
import et.bo.screen.service.HotlineService;
import et.bo.screen.service.MarAnalysisService;
import et.bo.screen.service.ScreenService;
import et.po.ScreenOperSadinfo;
import et.po.ScreenPriceDay;
import excellence.framework.base.action.BaseAction;
import excellence.framework.base.container.SpringRunningContainer;
import excellence.framework.base.dto.impl.DynaBeanDTO;
/** 
 * MyEclipse Struts
 * Creation date: 06-26-2008
 * 
 * XDoclet definition:
 * @struts.action parameter="method" validate="true"
 * @author wangwenquan
 */
public class ScreenAction extends BaseAction {
	/*
	 * Generated Methods
	 */
	private ScreenService ss;
	/**
	 * 12316快讯
	 */
	public ActionForward toQuickMessageAdd(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		String title = request.getParameter("title");
		if(title==null)
			title = "";
		String content = request.getParameter("content");
		if(content==null)
			content = "";
		if(!"".equals(title.trim())&&!"".equals(content.trim()))
		{
			ss.addQuickMessage(title, content);
		}
		List oneElemList = new ArrayList();
		List quickList = ss.quickMessageList();
		if(quickList.size()>0)
		{
			//只取一条记录6
			oneElemList.add(quickList.get(0));
		}
		request.getSession().setAttribute("list",oneElemList);
		return mapping.findForward("quickMsgList");
	}
	/** 
	 * Method execute
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward toScreenPriceInfoList(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		List<ScreenPriceDay> list=ss.getScreenPriceInfo();
		request.setAttribute("list",list);
		return mapping.findForward("priceInfoday");
	}
	/**
	 * 每日供求
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward toScreenSadInfoList(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		List<ScreenOperSadinfo> list=ss.getScreenSadInfo();
		request.setAttribute("list",list);
		return mapping.findForward("sadInfo");
	}
	/**
	 * 金典案例查询 包括主题 内容 答案
	 */
	public ActionForward toCaseInfoList(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		List<DynaBeanDTO> list=ss.getCaseInfoList();
		request.setAttribute("list",list);
		return mapping.findForward("caseInfo");
	}
	/**
	 * 话务统计huaWuList()
	 */
	public ActionForward toHuaWuList(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		List<DynaBeanDTO> list=ss.huaWuList();
		request.setAttribute("list",list);
		return mapping.findForward("huwuList");
	}
	/**
	 * 焦点案例查询
	 * jiaoDianQuery
	 */
	public ActionForward toJiaoDianAnliList(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		List<DynaBeanDTO> list=ss.jiaoDianAnliList();
		request.setAttribute("list",list);
		return mapping.findForward("jiaoDianList");
	}
	/**
	 * 资讯汇总查询
	 * jiaoDianQuery
	 */
	public ActionForward toZixunSumDto(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		DynaBeanDTO dto=ss.getZiXunSumDtl();
		//System.out.println(dto.get("zixunsum")+"!!!!");
		List<DynaBeanDTO> list = new ArrayList<DynaBeanDTO>();
		list.add(dto);
		request.setAttribute("list",list);
		return mapping.findForward("zixunSumList");
	}
	
	/**
	 * 金农快讯中的数据信息
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward caseStudy(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		GeneralCaseinfoService gcs = (GeneralCaseinfoService)SpringRunningContainer.getInstance().getBean("GeneralCaseinfoService");
		JSONArray jsonArray = JSONArray.fromObject(gcs.screenList());
		outJsonString(response,jsonArray.toString());
		return null;
	}
	/**
	 * 农民版跟我学种养信息
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward agroPlant(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		GeneralCaseinfoService gcs = (GeneralCaseinfoService)SpringRunningContainer.getInstance().getBean("GeneralCaseinfoService");
		JSONArray jsonArray = JSONArray.fromObject(gcs.generalCaseinfoQuery(20,"已审"));
		outJsonString(response,jsonArray.toString());
		return null;
	}
	/**
	 * 焦点追踪中的数据信息
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward FocusTracking(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		FocusTrackingService fts = (FocusTrackingService)SpringRunningContainer.getInstance().getBean("FocusTrackingService");
		JSONArray jsonArray = JSONArray.fromObject(fts.screenList());
		outJsonString(response,jsonArray.toString());
		return null;
	}
	
	/**
	 * wwq
	 * 金农市 场分析的数据信息
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward marAnalysisStudy(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		String sizeStr = request.getParameter("showSize")==null?(String)request.getAttribute("showSize"):request.getParameter("showSize");
		MarAnalysisService ms = (MarAnalysisService)SpringRunningContainer.getInstance().getBean("marAnalysisService");
		JSONArray jsonArray = JSONArray.fromObject(ms.marketAnalysisInfoQuery(Integer.parseInt(sizeStr)));

		
		outJsonString(response,jsonArray.toString());
		return null;
	}
	
	//////////////////////////////////////////////////////////////////////zhang feng add test flexgrid////////////////////////////////////////////////////////////////////////////////////
	/**
	 * 
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward flexData(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {

		MessagesService ms = (MessagesService)SpringRunningContainer.getInstance().getBean("MessagesService");
		JSONArray jsonArray = JSONArray.fromObject(ms.messageList());
		String reslut = "{\"total\":200,\"page\":2,\"rows\":"+jsonArray.toString()+"}";
		System.out.println(reslut);
		outJsonString(response,reslut);
		return null;
	}
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	/**
	
	/**
	 * 金农热线中的数据信息
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward hotline(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		HotlineService gcs = (HotlineService)SpringRunningContainer.getInstance().getBean("hotlineService");
		JSONArray jsonArray = JSONArray.fromObject(gcs.screenList());
		outJsonString(response,jsonArray.toString());
		return null;
	}
	/**
	 * @return ss
	 */
	public ScreenService getSs() {
		return ss;
	}
	/**
	 * @param ss 要设置的 ss
	 */
	public void setSs(ScreenService ss) {
		this.ss = ss;
	}
}